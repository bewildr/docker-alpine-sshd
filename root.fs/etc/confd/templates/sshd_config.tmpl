# Generated by confd {{getenv "CONFD_VERSION"}} on {{getenv "HOSTNAME"}}
#	$OpenBSD: sshd_config,v 1.101 2017/03/14 07:19:07 djm Exp $

# This is the sshd server system-wide configuration file.  See
# sshd_config(5) for more information.

# This sshd was compiled with PATH=/bin:/usr/bin:/sbin:/usr/sbin

# The strategy used for options in the default sshd_config shipped with
# OpenSSH is to specify options with their default value where
# possible, but leave them commented.  Uncommented options override the
# default value.

{{if ls "/sshd/port"}}Port = {{getv "/sshd/port"}}{{end}}
{{if ls "/sshd/addressfamily"}}AddressFamily = {{getv "/sshd/addressfamily"}}{{end}}
{{range gets "/sshd/listenaddress/*"}}ListenAddress = {{.Value}}{{end}}

{{if ls "/sshd/hostkey"}}HostKey = {{getv "/sshd/hostkey"}}{{end}}
{{if ls "/sshd/hostkey"}}HostKey = {{getv "/sshd/hostkey"}}{{end}}
{{if ls "/sshd/hostkey"}}HostKey = {{getv "/sshd/hostkey"}}{{end}}
{{if ls "/sshd/hostkey"}}HostKey = {{getv "/sshd/hostkey"}}{{end}}

# Ciphers and keying
{{if ls "/sshd/rekeylimit"}}RekeyLimit = {{getv "/sshd/rekeylimit"}}{{end}}

# Logging
{{if ls "/sshd/syslogfacility"}}SyslogFacility = {{getv "/sshd/syslogfacility"}}{{end}}
{{if ls "/sshd/loglevel"}}LogLevel = {{getv "/sshd/loglevel"}}{{end}}

# Authentication:

{{if ls "/sshd/logingracetime"}}LoginGraceTime = {{getv "/sshd/logingracetime"}}{{end}}
{{if ls "/sshd/permitrootlogin"}}PermitRootLogin = {{getv "/sshd/permitrootlogin"}}{{end}}
{{if ls "/sshd/strictmodes"}}StrictModes = {{getv "/sshd/strictmodes"}}{{end}}
{{if ls "/sshd/maxauthtries"}}MaxAuthTries = {{getv "/sshd/maxauthtries"}}{{end}}
{{if ls "/sshd/maxsessions"}}MaxSessions = {{getv "/sshd/maxsessions"}}{{end}}

{{if ls "/sshd/pubkeyauthentication"}}PubkeyAuthentication = {{getv "/sshd/pubkeyauthentication"}}{{end}}

# The default is to check both .ssh/authorized_keys and .ssh/authorized_keys2
# but this is overridden so installations will only check .ssh/authorized_keys
AuthorizedKeysFile	.ssh/authorized_keys

{{if ls "/sshd/authorizedprincipalsfile"}}AuthorizedPrincipalsFile = {{getv "/sshd/authorizedprincipalsfile"}}{{end}}

{{if ls "/sshd/authorizedkeyscommand"}}AuthorizedKeysCommand = {{getv "/sshd/authorizedkeyscommand"}}{{end}}
{{if ls "/sshd/authorizedkeyscommanduser"}}AuthorizedKeysCommandUser = {{getv "/sshd/authorizedkeyscommanduser"}}{{end}}

# For this to work you will also need host keys in /etc/ssh/ssh_known_hosts
{{if ls "/sshd/hostbasedauthentication"}}HostbasedAuthentication = {{getv "/sshd/hostbasedauthentication"}}{{end}}
# Change to yes if you don't trust ~/.ssh/known_hosts for
# HostbasedAuthentication
{{if ls "/sshd/ignoreuserknownhosts"}}IgnoreUserKnownHosts = {{getv "/sshd/ignoreuserknownhosts"}}{{end}}
# Don't read the user's ~/.rhosts and ~/.shosts files
{{if ls "/sshd/ignorerhosts"}}IgnoreRhosts = {{getv "/sshd/ignorerhosts"}}{{end}}

# To disable tunneled clear text passwords, change to no here!
{{if ls "/sshd/passwordauthentication"}}PasswordAuthentication = {{getv "/sshd/passwordauthentication"}}{{end}}
{{if ls "/sshd/permitemptypasswords"}}PermitEmptyPasswords = {{getv "/sshd/permitemptypasswords"}}{{end}}

# Change to no to disable s/key passwords
{{if ls "/sshd/challengeresponseauthentication"}}ChallengeResponseAuthentication = {{getv "/sshd/challengeresponseauthentication"}}{{end}}

# Kerberos options
{{if ls "/sshd/kerberosauthentication"}}KerberosAuthentication = {{getv "/sshd/kerberosauthentication"}}{{end}}
{{if ls "/sshd/kerberosorlocalpasswd"}}KerberosOrLocalPasswd = {{getv "/sshd/kerberosorlocalpasswd"}}{{end}}
{{if ls "/sshd/kerberosticketcleanup"}}KerberosTicketCleanup = {{getv "/sshd/kerberosticketcleanup"}}{{end}}
{{if ls "/sshd/kerberosgetafstoken"}}KerberosGetAFSToken = {{getv "/sshd/kerberosgetafstoken"}}{{end}}

# GSSAPI options
{{if ls "/sshd/gssapiauthentication"}}GSSAPIAuthentication = {{getv "/sshd/gssapiauthentication"}}{{end}}
{{if ls "/sshd/gssapicleanupcredentials"}}GSSAPICleanupCredentials = {{getv "/sshd/gssapicleanupcredentials"}}{{end}}

# Set this to 'yes' to enable PAM authentication, account processing,
# and session processing. If this is enabled, PAM authentication will
# be allowed through the ChallengeResponseAuthentication and
# PasswordAuthentication.  Depending on your PAM configuration,
# PAM authentication via ChallengeResponseAuthentication may bypass
# the setting of "PermitRootLogin without-password".
# If you just want the PAM account and session checks to run without
# PAM authentication, then enable this but set PasswordAuthentication
# and ChallengeResponseAuthentication to 'no'.
{{if ls "/sshd/usepam"}}UsePAM = {{getv "/sshd/usepam"}}{{end}}

{{if ls "/sshd/allowagentforwarding"}}AllowAgentForwarding = {{getv "/sshd/allowagentforwarding"}}{{end}}
{{if ls "/sshd/allowtcpforwarding"}}AllowTcpForwarding = {{getv "/sshd/allowtcpforwarding"}}{{end}}
{{if ls "/sshd/gatewayports"}}GatewayPorts = {{getv "/sshd/gatewayports"}}{{end}}
{{if ls "/sshd/x11forwarding"}}X11Forwarding = {{getv "/sshd/x11forwarding"}}{{end}}
{{if ls "/sshd/x11displayoffset"}}X11DisplayOffset = {{getv "/sshd/x11displayoffset"}}{{end}}
{{if ls "/sshd/x11uselocalhost"}}X11UseLocalhost = {{getv "/sshd/x11uselocalhost"}}{{end}}
{{if ls "/sshd/permittty"}}PermitTTY = {{getv "/sshd/permittty"}}{{end}}
{{if ls "/sshd/printmotd"}}PrintMotd = {{getv "/sshd/printmotd"}}{{end}}
{{if ls "/sshd/printlastlog"}}PrintLastLog = {{getv "/sshd/printlastlog"}}{{end}}
{{if ls "/sshd/tcpkeepalive"}}TCPKeepAlive = {{getv "/sshd/tcpkeepalive"}}{{end}}
{{if ls "/sshd/uselogin"}}UseLogin = {{getv "/sshd/uselogin"}}{{end}}
{{if ls "/sshd/permituserenvironment"}}PermitUserEnvironment = {{getv "/sshd/permituserenvironment"}}{{end}}
{{if ls "/sshd/compression"}}Compression = {{getv "/sshd/compression"}}{{end}}
{{if ls "/sshd/clientaliveinterval"}}ClientAliveInterval = {{getv "/sshd/clientaliveinterval"}}{{end}}
{{if ls "/sshd/clientalivecountmax"}}ClientAliveCountMax = {{getv "/sshd/clientalivecountmax"}}{{end}}
{{if ls "/sshd/usedns"}}UseDNS = {{getv "/sshd/usedns"}}{{end}}
{{if ls "/sshd/pidfile"}}PidFile = {{getv "/sshd/pidfile"}}{{end}}
{{if ls "/sshd/maxstartups"}}MaxStartups = {{getv "/sshd/maxstartups"}}{{end}}
{{if ls "/sshd/permittunnel"}}PermitTunnel = {{getv "/sshd/permittunnel"}}{{end}}
{{if ls "/sshd/chrootdirectory"}}ChrootDirectory = {{getv "/sshd/chrootdirectory"}}{{end}}
{{if ls "/sshd/versionaddendum"}}VersionAddendum = {{getv "/sshd/versionaddendum"}}{{end}}

# no default banner path
{{if ls "/sshd/banner"}}Banner = {{getv "/sshd/banner"}}{{end}}

# override default of no subsystems
Subsystem	sftp	/usr/lib/ssh/sftp-server

# the following are HPN related configuration options
# tcp receive buffer polling. disable in non autotuning kernels
{{if ls "/sshd/tcprcvbufpoll"}}TcpRcvBufPoll = {{getv "/sshd/tcprcvbufpoll"}}{{end}}
 
# disable hpn performance boosts
{{if ls "/sshd/hpndisabled"}}HPNDisabled = {{getv "/sshd/hpndisabled"}}{{end}}

# buffer size for hpn to non-hpn connections
{{if ls "/sshd/hpnbuffersize"}}HPNBufferSize = {{getv "/sshd/hpnbuffersize"}}{{end}}


# Example of overriding settings on a per-user basis
{{if ls "/sshd/match"}}Match = {{getv "/sshd/match"}}{{end}}
{{if ls "/sshd/x11forwarding"}}X11Forwarding = {{getv "/sshd/x11forwarding"}}{{end}}
{{if ls "/sshd/allowtcpforwarding"}}AllowTcpForwarding = {{getv "/sshd/allowtcpforwarding"}}{{end}}
{{if ls "/sshd/permittty"}}PermitTTY = {{getv "/sshd/permittty"}}{{end}}
{{if ls "/sshd/forcecommand"}}ForceCommand = {{getv "/sshd/forcecommand"}}{{end}}

# end of generated configuration